(this["webpackJsonpteams-messaging-extension-action-bot"]=this["webpackJsonpteams-messaging-extension-action-bot"]||[]).push([[0],{238:function(e,t,n){},239:function(e,t,n){},240:function(e,t,n){},369:function(e,t,n){},378:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n(36),o=n.n(i),a=(n(238),n(239),n(206)),s=n(143),r=n(19),u=n(116),l=n(114),d=n(115),j=(n(240),n(87)),m=n.n(j),h=n(457),f=n(10),g=function(e){var t=e.userId,n=c.useRef(null),i=c.useRef(null),o=c.useRef(null);c.useEffect((function(){n.current&&b(n.current)}),[n]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("video",{onCanPlay:function(){console.log("can play")},ref:n,className:"videoContainer"}),Object(f.jsx)(d.a,{content:"Take photo",onClick:function(e){x(i.current,n.current,o),e.preventDefault()}}),Object(f.jsx)("canvas",{ref:i,className:"canvasContainer"}),Object(f.jsx)(d.a,{content:"Upload",onClick:function(){!function(e,t){m.a.post("https://www.l2b.ltd/v1/CustomEmoji",{emoji_id:Object(h.a)(),emoji_display_name:"test",emoji_author_userId:e,emoji_description:"test description",emoji_state:1,emoji_base64_content:t}).then((function(e){console.log("upload succeed")})).catch((function(e){console.log("upload failed: ".concat(e))}))}(t,o.current)}}),Object(f.jsx)(d.a,{content:"Cancel",onClick:function(){p(i.current,o.current)}})]})},b=function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){e.srcObject=t,e.play()})).catch((function(e){console.log("An error occurred: "+e)}))},x=function(e,t,n){var c=e.getContext("2d");e.width=320,e.height=240,c.drawImage(t,0,0,320,240);var i=e.toDataURL("image/png");n.current=v(i),console.log("take photo")},v=function(e){var t=e.indexOf("base64,");return e.substring(t+7)},p=function(e,t){var n=e.getContext("2d");n.fillStyle="#AAA",n.fillRect(0,0,e.width,e.height),console.log("photo: ".concat(JSON.stringify(null)))},O=n(225),w=n(445),y=n(57),I=n(49),C=n(446),_=n(447),k=n(227),S=n(213),A=n(214),E=n.n(A),M=["WandaHoward","TimDeboer","RobinCounts","RobertTolbert","MonaKane","MiguelGarcia","MauricioAugust","LydiaBauer","KristinPatterson","KevinSturgis","KatriAthokas","KatLarsson","JohnieMcConnell","IsaacFielder","HenryBrill","ErikNason","ElviaAtkins"],R={width:"calc(100% - 10px)",height:"80%",margin:"10px 5px"},D=function(e){var t=e.style,n=c.useRef(null),i=c.useCallback((function(){n&&n.current&&n.current.click()})),o=c.useCallback((function(e){}));return Object(f.jsxs)("div",{style:t,children:[Object(f.jsx)("input",{id:"fileButton",ref:n,onChange:o,type:"file",hidden:!0}),Object(f.jsxs)(d.a,{text:!0,styles:R,onClick:i,children:[Object(f.jsx)(w.a,{}),Object(f.jsx)(y.a,{weight:"semibold",content:"Upload Emoji"})]},"add_emoji")]})},K=function(e){var t=e.columnIndex,n=e.data,c=e.rowIndex,i=e.style,o=c*n.columnCount+t,a=n.items&&n.items.length>o?n.items[o]:null;if(!a)return null;if("add-emoji"===a.id)return Object(f.jsx)(D,{style:i});var s=function(e){!function(e,t,n,c,i){m.a.post("https://www.l2b.ltd/api/message-reactions",{emoji_id:e,user_id:t,message_id:n,chat_id:c,emoji_url:i}).then((function(){console.log("select image succeed")})).catch((function(e){console.log("select image failed: ".concat(e))}))}(e.id,n.userId,n.messageId,n.convId,e.src)};return Object(f.jsx)("div",{style:i,children:Object(f.jsx)(d.a,{styles:R,text:!0,title:a.name,onClick:function(){return s(a)},children:Object(f.jsx)(I.a,{style:{maxHeight:"100%",maxWidth:"100%"},src:a.src})},a.id)})},N=function(e){var t=e.messageId,n=e.userId,i=e.convId,o=c.useState([]),a=Object(u.a)(o,2),s=a[0],r=a[1];c.useEffect((function(){m.a.get("https://www.l2b.ltd/v1/CustomEmoji").then((function(e){return console.log("fetch images succeed: ".concat(e)),e.data.map((function(e){return{id:e.emoji_id,name:e.emoji_display_name,src:e.emoji_url}}))})).catch((function(e){console.log("fetch images failed: ".concat(e))})).then((function(e){r(e||E.a.map(M,(function(e){return{id:e,name:e,src:"https://fabricweb.azureedge.net/fabric-website/assets/images/avatar/".concat(e,".jpg")}})))}))}),[]);var l=[{id:"add-emoji"}].concat(Object(O.a)(s)),d=Math.ceil(l.length/6),j=c.useMemo((function(){return{columnCount:6,items:l,messageId:t,userId:n,convId:i}})),h=Object(f.jsx)(S.a,{children:function(e){return function(e,t){var n=Math.floor(t/6);return Object(f.jsx)(k.a,{className:"FixedSizeGrid",columnCount:6,rowCount:d,width:t,height:e,columnWidth:n,rowHeight:150,initialScrollTop:0,itemData:j,style:{overflowX:"hidden"},children:K})}(e.height,e.width)}});return Object(f.jsx)(C.a,{accessibility:_.a,content:h,style:{height:"100%",width:"100%"}})},T=(n(369),[{key:"custom_emojis",content:"Custom Emojis"},{key:"shoot_emoji",content:"Shoot emoji"}]),U=function(){var e=new URLSearchParams(Object(r.d)().search),t=e.get("messageId"),n=e.get("userId"),i=e.get("convId"),o=c.useState(0),a=Object(u.a)(o,2),s=a[0],d=a[1],j=c.useCallback((function(e,t){d(t.activeIndex)}));return Object(f.jsxs)("div",{id:"main-page",style:{height:"100%"},children:[Object(f.jsx)(l.a,{defaultActiveIndex:0,items:T,underlined:!0,primary:!0,onActiveIndexChange:j}),0===s&&Object(f.jsx)(N,{messageId:t,userId:n,convId:i}),1===s&&Object(f.jsx)(g,{userId:n})]})};var B=function(){return a?Object(f.jsx)(s.a,{children:Object(f.jsx)(U,{})}):Object(f.jsx)("h3",{children:"Microsoft Teams SDK not found."})},H=n(455),J=n(454);o.a.render(Object(f.jsx)(H.a,{theme:J.a,children:Object(f.jsx)(B,{})}),document.getElementById("root"))}},[[378,1,2]]]);
//# sourceMappingURL=main.76f2c3c4.chunk.js.map