(this["webpackJsonpteams-messaging-extension-action-bot"]=this["webpackJsonpteams-messaging-extension-action-bot"]||[]).push([[0],{115:function(e,t,n){},302:function(e,t,n){},322:function(e,t,n){},323:function(e,t,n){},324:function(e,t,n){},459:function(e,t,n){},464:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(38),i=n.n(s),o=(n(302),n(115),n(42)),r=n(278),u=n(26),A=n(9),l=n(11),d=n(30),j=n(31),f=n(7),h=(a.a.Component,a.a.Component,n(3)),m=n.n(h),g=n(33),p=n(82),b=n.n(p),O=(n(322),n(266)),v=n(130),x=n(556),I=(n(323),"data:image/png;base64,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"),C=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(A.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(f.jsxs)("div",{className:"profile",children:[Object(f.jsx)("div",{className:"photo",children:Object(f.jsx)("img",{src:I,alt:"avatar"})}),Object(f.jsxs)("div",{className:"info",children:[Object(f.jsx)("div",{className:"name",children:this.props.userInfo.displayName}),Object(f.jsx)("div",{className:"email",children:this.props.userInfo.preferredUserName})]})]})}}]),n}(a.a.Component),y=C,w=(n(324),n(553)),B=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var c;return Object(A.a)(this,n),(c=t.call(this,e)).state={displayName:"",photoObjectURL:""},c}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(g.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.fetchData();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(g.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.objectId!==this.props.objectId&&this.fetchData();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchData",value:function(){var e=Object(g.a)(m.a.mark((function e(){var t,n,c,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(w.a)(this.props.credential,this.props.scope);case 3:return t=e.sent,e.next=6,t.api("/users/".concat(this.props.objectId)).get();case 6:return n=e.sent.displayName,e.prev=7,e.next=10,t.api("/users/".concat(this.props.objectId,"/photo/$value")).get();case 10:a=e.sent,c=URL.createObjectURL(a),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(7);case 16:this.setState({displayName:n,photoObjectURL:c}),e.next=22;break;case 19:e.prev=19,e.t1=e.catch(0),console.log(e.t1);case 22:case"end":return e.stop()}}),e,this,[[0,19],[7,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(f.jsxs)("div",{className:"creator",children:[Object(f.jsx)("div",{children:Object(f.jsx)("img",{src:this.state.photoObjectURL?this.state.photoObjectURL:I,alt:"avatar"})}),Object(f.jsx)("div",{className:"name",children:this.state.displayName})]})}}]),n}(a.a.Component),R=B,k=n(287),D=n(165),E=n(554),L=n(166),Q=n.p+"static/media/no-item.d0ba5a28.png",S=(a.a.Component,a.a.Component,n(167)),P=n(103),U=(n(459),n(468)),z=function(e){var t=e.userId,n=c.useRef(null),a=c.useRef(null),s=c.useRef(null);c.useEffect((function(){n.current&&N(n.current)}),[n]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("video",{onCanPlay:function(){console.log("can play")},ref:n,className:"videoContainer"}),Object(f.jsx)(L.a,{content:"Take photo",onClick:function(e){V(a.current,n.current,s),e.preventDefault()}}),Object(f.jsx)("canvas",{ref:a,className:"canvasContainer"}),Object(f.jsx)(L.a,{content:"Upload",onClick:function(){!function(e,t){b.a.post("https://customemojiwebapiapi.azure-api.net/v1/CustomEmoji",{emoji_id:new U.a,emoji_display_name:"test",emoji_autho_userId:e,emoji_state:1,emoji_base64_content:JSON.stringify(t)}).then((function(e){console.log("upload succeed")})).catch((function(e){console.log("upload failed: ".concat(e))}))}(t,s.current)}}),Object(f.jsx)(L.a,{content:"Cancel",onClick:function(){H(a.current,s.current)}})]})},N=function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){e.srcObject=t,e.play()})).catch((function(e){console.log("An error occurred: "+e)}))},V=function(e,t,n){var c=e.getContext("2d");e.width=320,e.height=240,c.drawImage(t,0,0,320,240);var a=e.toDataURL("image/png").replace("image/png","image/octet-stream");n.current=a,console.log("take photo")},H=function(e,t){var n=e.getContext("2d");n.fillStyle="#AAA",n.fillRect(0,0,e.width,e.height),console.log("photo: ".concat(JSON.stringify(null)))},T=n(70),Y=n(547),M=n(81),J=n(548),W=n(549),X=n(277),G=n.n(X),F=["WandaHoward","TimDeboer","RobinCounts","RobertTolbert","MonaKane","MiguelGarcia","MauricioAugust","LydiaBauer","KristinPatterson","KevinSturgis","KatriAthokas","KatLarsson","JohnieMcConnell","IsaacFielder","HenryBrill","ErikNason","ElviaAtkins"],K={minWidth:"150px",maxWidth:"150px",height:"150px",padding:"0",margin:"5px"},q=function(e,t){return e&&e.map((function(e){return Object(f.jsx)(L.a,{styles:K,title:e.name,onClick:function(){return function(e){t(e)}(e)},children:Object(f.jsx)(T.a,{fluid:!0,src:e.src})},e.id)}))},Z=function(e,t){var n=q(e,t),a=function(){var e=c.useRef(null),t=c.useCallback((function(){e&&e.current&&e.current.click()})),n=c.useCallback((function(e){}));return Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{id:"fileButton",ref:e,onChange:n,type:"file",hidden:!0}),Object(f.jsxs)(L.a,{styles:K,onClick:t,children:[Object(f.jsx)(Y.a,{}),Object(f.jsx)(M.a,{weight:"semibold",content:"Upload Emoji"})]},"add_emoji")]})}();return n&&n.unshift(a),n||a},_=function(e){var t=e.messageId,n=e.userId,a=e.convId,s=c.useState([]),i=Object(S.a)(s,2),o=i[0],r=i[1];c.useEffect((function(){b.a.get("https://customemojiwebapiapi.azure-api.net/v1/CustomEmoji",{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(e){return console.log("fetch images succeed: ".concat(e)),JSON.parse(e).map((function(e){return{id:e.emoji_id,name:e.emoji_display_name,source:e.emoji_url}}))})).catch((function(e){console.log("fetch images failed: ".concat(e))})).then((function(e){r(e||G.a.map(F,(function(e){return{id:e,name:e,src:"https://fabricweb.azureedge.net/fabric-website/assets/images/avatar/".concat(e,".jpg")}})))}))}),[]);return Object(f.jsx)("div",{children:Object(f.jsx)(J.a,{accessibility:W.a,columns:8,content:Z(o,(function(e){!function(e,t,n,c,a){b.a.post("https://www.l2b.ltd/api/message-reactions",{emoji_id:e,user_id:t,message_id:n,chat_id:c,emoji_url:a}).then((function(){console.log("select image succeed")})).catch((function(e){console.log("select image failed: ".concat(e))}))}(e.id,n,t,a,e.src)}))})})},$=[{key:"custom_emojis",content:"Custom Emojis"},{key:"shoot_emoji",content:"Shoot emoji"}],ee=function(e){var t=e.messageId,n=e.userId,a=e.convId,s=c.useState(0),i=Object(S.a)(s,2),o=i[0],r=i[1],u=c.useCallback((function(e,t){r(t.activeIndex)}));return Object(f.jsxs)("div",{children:[Object(f.jsx)(P.a,{defaultActiveIndex:0,items:$,underlined:!0,primary:!0,onActiveIndexChange:u}),0===o&&Object(f.jsx)(_,{messageId:t,userId:n,convId:a}),1===o&&Object(f.jsx)(z,{userId:n})]})};function te(){var e=new URLSearchParams(Object(u.d)().search);return console.log(e.toString()),Object(f.jsx)(ne,{messageId:e.get("messageId"),userId:e.get("userId"),convId:e.get("convId")})}function ne(e){var t=e.messageId,n=e.userId,c=e.convId;return Object(f.jsxs)("div",{children:[Object(f.jsxs)("h1",{children:["messageId: ",t," "]}),Object(f.jsxs)("h1",{children:["userId: ",n," "]}),Object(f.jsxs)("h1",{children:["convId: ",c," "]}),Object(f.jsx)(ee,{messageId:t,userId:n,convId:c})]})}var ce=function(){return o?Object(f.jsx)(r.a,{children:Object(f.jsx)(te,{})}):Object(f.jsx)("h3",{children:"Microsoft Teams SDK not found."})},ae=n(551),se=n(550);i.a.render(Object(f.jsx)(ae.a,{theme:se.a,children:Object(f.jsx)(ce,{})}),document.getElementById("root"))}},[[464,1,2]]]);
//# sourceMappingURL=main.9750bcac.chunk.js.map