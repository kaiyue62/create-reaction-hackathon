{"version":3,"sources":["components/about/Privacy.js","components/about/TermsOfUse.js","images/default-photo.png","components/Profile.js","components/Creator.js","images/no-item.png","components/Tab.js","components/TabConfig.js","components/Camera.jsx","components/data.js","components/MockData.js","components/CustomEmojis.jsx","components/MainPage.jsx","components/App.js","index.js"],"names":["React","Component","Profile","className","src","defaultPhoto","alt","this","props","userInfo","displayName","preferredUserName","Creator","state","photoObjectURL","a","fetchData","prevProps","objectId","createMicrosoftGraphClient","credential","scope","graphClient","api","get","photoBlob","URL","createObjectURL","setState","console","log","Camera","userId","videoRef","canvasRef","photoRef","current","init","onCanPlay","ref","Button","content","onClick","e","takePicture","preventDefault","photo","axios","post","emoji_id","uuid","emoji_display_name","emoji_autho_userId","emoji_state","emoji_base64_content","JSON","stringify","then","response","catch","uploadUserImage","clearPhoto","video","navigator","mediaDevices","getUserMedia","audio","stream","srcObject","play","err","canvas","context","getContext","width","height","drawImage","data","toDataURL","replace","fillStyle","fillRect","imageNames","imageButtonStyles","minWidth","maxWidth","padding","margin","renderImageButtons","allEmojis","onEmojiClick","map","emoji","styles","title","name","Image","fluid","id","renderGridContents","allEmojisButtons","addEmojiButton","fileInputRef","onAddButtonClick","click","fileUploadInputChange","onChange","type","hidden","AddIcon","Text","weight","renderAddEmojiButton","unshift","CustomEmojisComponent","messageId","convId","setAllEmojis","headers","parse","image","source","emoji_url","emojis","_","imageName","Grid","accessibility","gridHorizontalBehavior","columns","emojiId","msgId","chatId","emotionSrc","user_id","message_id","chat_id","selectCustomImage","items","key","MainPage","activeIndex","setActiveIndex","onActiveIndexChange","i","j","Menu","defaultActiveIndex","underlined","primary","Parent","query","URLSearchParams","useLocation","search","toString","Child","App","microsoftTeams","ReactDOM","render","Provider","theme","teamsTheme","document","getElementById"],"mappings":"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","file":"static/js/main.9750bcac.chunk.js","sourcesContent":["// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport '../App.css';\r\n\r\n/**\r\n * This component is used to display the required\r\n * privacy statement which can be found in a link in the\r\n * about tab.\r\n */\r\nclass Privacy extends React.Component {\r\n    render() {\r\n      return (\r\n        <div>\r\n          <h1>Privacy Statement</h1>\r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\nexport default Privacy;","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport '../App.css';\r\n\r\n/**\r\n * This component is used to display the required\r\n * terms of use statement which can be found in a\r\n * link in the about tab.\r\n */\r\nclass TermsOfUse extends React.Component {\r\n    render() {\r\n      return (\r\n        <div>\r\n          <h1>Terms of Use</h1>\r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\nexport default TermsOfUse;","export default \"data:image/png;base64,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\"","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './Profile.css';\r\nimport defaultPhoto from '../images/default-photo.png'\r\n\r\nclass Profile extends React.Component {\r\n  render() {\r\n    return (\r\n      <div className=\"profile\">\r\n        <div className=\"photo\">\r\n          <img src={defaultPhoto} alt=\"avatar\"/>\r\n        </div>\r\n        <div className=\"info\">\r\n          <div className=\"name\">{this.props.userInfo.displayName}</div>\r\n          <div className=\"email\">{this.props.userInfo.preferredUserName}</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Profile;","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './Creator.css';\r\nimport { createMicrosoftGraphClient } from \"@microsoft/teamsfx\";\r\nimport defaultPhoto from '../images/default-photo.png'\r\n\r\nclass Creator extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      displayName: \"\",\r\n      photoObjectURL: \"\",\r\n    }\r\n  }\r\n\r\n  async componentDidMount() {\r\n    this.fetchData();\r\n  }\r\n\r\n  async componentDidUpdate(prevProps) {\r\n    if (prevProps.objectId !== this.props.objectId) {\r\n      this.fetchData();\r\n    }\r\n  }\r\n\r\n  async fetchData() {\r\n    try {\r\n      // Get Microsoft graph client\r\n      const graphClient = await createMicrosoftGraphClient(this.props.credential, this.props.scope);\r\n      const displayName = (await graphClient.api(`/users/${this.props.objectId}`).get()).displayName;\r\n      let photoObjectURL;\r\n      try {\r\n        const photoBlob = await graphClient.api(`/users/${this.props.objectId}/photo/$value`).get()\r\n        photoObjectURL = URL.createObjectURL(photoBlob);\r\n      } catch (error) {\r\n      }\r\n      this.setState({\r\n        displayName,\r\n        photoObjectURL,\r\n      });\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"creator\">\r\n        <div>\r\n          <img src={this.state.photoObjectURL ? this.state.photoObjectURL : defaultPhoto} alt=\"avatar\" />\r\n        </div>\r\n        <div className=\"name\">{this.state.displayName}</div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Creator;","export default __webpack_public_path__ + \"static/media/no-item.d0ba5a28.png\";","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport axios from 'axios';\r\nimport './App.css';\r\nimport './Tab.css'\r\nimport {\r\n  TeamsUserCredential,\r\n  loadConfiguration,\r\n  getResourceConfiguration,\r\n  ResourceType\r\n} from \"@microsoft/teamsfx\";\r\nimport Profile from \"./Profile\";\r\nimport Creator from \"./Creator\";\r\nimport { Checkbox, Button, Input, MenuButton } from \"@fluentui/react-northstar\"\r\nimport noItemimage from '../images/no-item.png'\r\nimport * as microsoftTeams from '@microsoft/teams-js';\r\n\r\nclass Tab extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      userInfo: {},\r\n      items: [],\r\n      newItemDescription: \"\",\r\n      showLoginPage: undefined,\r\n      isAddingItem: false,\r\n      initialized: false\r\n    }\r\n  }\r\n\r\n  async componentDidMount() {\r\n    await this.initTeamsFx();\r\n    await this.initData();\r\n  }\r\n\r\n  async initTeamsFx() {\r\n    // Initialize configuration from environment variables and set the global instance\r\n    loadConfiguration({\r\n      authentication: {\r\n        initiateLoginEndpoint: process.env.REACT_APP_START_LOGIN_PAGE_URL,\r\n        simpleAuthEndpoint: process.env.REACT_APP_TEAMSFX_ENDPOINT,\r\n        clientId: process.env.REACT_APP_CLIENT_ID\r\n      },\r\n      resources: [\r\n        {\r\n          type: ResourceType.API,\r\n          name: \"default\",\r\n          properties: {\r\n            endpoint: process.env.REACT_APP_FUNC_ENDPOINT\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    const credential = new TeamsUserCredential();\r\n    // Get the user info from access token\r\n    const userInfo = await credential.getUserInfo();\r\n\r\n    this.setState({\r\n      userInfo: userInfo\r\n    });\r\n\r\n    this.credential = credential;\r\n    this.scope = [\"User.Read\", \"User.ReadBasic.All\"];\r\n    this.channelOrChatId = await this.getChannelOrChatId();\r\n  }\r\n\r\n  async initData() {\r\n    if (!await this.checkIsConsentNeeded()) {\r\n      await this.getItems();\r\n    }\r\n  }\r\n\r\n  async loginBtnClick() {\r\n    try {\r\n      // Popup login page to get user's access token\r\n      await this.credential.login(this.scope);\r\n    } catch (err) {\r\n      alert(\"Login failed: \" + err);\r\n      return;\r\n    }\r\n    await this.initData();\r\n  }\r\n\r\n  async checkIsConsentNeeded() {\r\n    try {\r\n      await this.credential.getToken(this.scope);\r\n    } catch (error) {\r\n      this.setState({\r\n        showLoginPage: true\r\n      });\r\n      return true;\r\n    }\r\n    this.setState({\r\n      showLoginPage: false\r\n    });\r\n    return false;\r\n  }\r\n\r\n  async getChannelOrChatId() {\r\n    return new Promise((resolve) => {\r\n      microsoftTeams.getContext((context) => {\r\n        if (context.channelId) {\r\n          resolve(context.channelId);\r\n        } else if (context.chatId) {\r\n          resolve(context.chatId);\r\n        } else {\r\n          resolve(this.state.userInfo.objectId);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  async callFunctionWithErrorHandling(command, method, options, params) {\r\n    var message = [];\r\n    var funcErrorMsg = \"\";\r\n    try {\r\n      // Get SSO token for the user\r\n      const accessToken = await this.credential.getToken(\"\");\r\n      // Gets configuration for API\r\n      const apiConfig = getResourceConfiguration(ResourceType.API);\r\n      const response = await axios.default.request({\r\n        method: method,\r\n        url: apiConfig.endpoint + \"/api/\" + command,\r\n        headers: {\r\n          authorization: \"Bearer \" + accessToken.token\r\n        },\r\n        data: options,\r\n        params\r\n      });\r\n      message = response.data;\r\n    } catch (err) {\r\n      if (err.response && err.response.status && err.response.status === 404) {\r\n        funcErrorMsg =\r\n          'There may be a problem with the deployment of Azure Function App, please deploy Azure Function (Run command palette \"TeamsFx - Deploy Package\") first before running this App';\r\n      } else if (err.message === \"Network Error\") {\r\n        funcErrorMsg =\r\n          \"Cannot call Azure Function due to network error, please check your network connection status and \";\r\n        if (err.config.url.indexOf(\"localhost\") >= 0) {\r\n          funcErrorMsg +=\r\n            'make sure to start Azure Function locally (Run \"npm run start\" command inside api folder from terminal) first before running this App';\r\n        } else {\r\n          funcErrorMsg +=\r\n            'make sure to provision and deploy Azure Function (Run command palette \"TeamsFx - Provision Resource\" and \"TeamsFx - Deploy Package\") first before running this App';\r\n        }\r\n      } else {\r\n        funcErrorMsg = err.toString();\r\n        if (err.response?.data?.error) {\r\n          funcErrorMsg += \": \" + err.response.data.error;\r\n        }\r\n        alert(funcErrorMsg);\r\n      }\r\n    }\r\n    return message;\r\n  }\r\n\r\n  async getItems() {\r\n    // Use client TeamsFx SDK to call \"todo\" Azure Function in \"get\" method to get all todo list which belong to user oid\r\n    let result = await this.callFunctionWithErrorHandling(\"todo\", \"get\", undefined, { channelOrChatId: this.channelOrChatId });\r\n    if (\"Error\" === result) {\r\n      throw new Error(\"todo Function failed, please check Azure Functions log for details!\");\r\n    } else {\r\n      this.setState({\r\n        items: result,\r\n        initialized: true,\r\n      });\r\n    }\r\n  }\r\n\r\n  async onAddItem() {\r\n    const newItems = JSON.parse(JSON.stringify(this.state.items));\r\n    newItems.push({\r\n      description: this.state.newItemDescription,\r\n      objectId: this.state.userInfo.objectId\r\n    })\r\n    this.setState({\r\n      newItemDescription: \"\",\r\n      items: newItems\r\n    });\r\n\r\n    // Use client TeamsFx SDK to call \"todo\" Azure Function in \"post\" method to insert a new todo item under user oid\r\n    await this.callFunctionWithErrorHandling(\"todo\", \"post\", {\r\n      description: this.state.newItemDescription, isCompleted: false, channelOrChatId: this.channelOrChatId\r\n    });\r\n    this.refresh();\r\n  }\r\n\r\n  async onUpdateItem(id, description) {\r\n    // Use client TeamsFx SDK to call \"todo\" Azure Function in \"put\" method to update a todo item\r\n    await this.callFunctionWithErrorHandling(\"todo\", \"put\", { id, description });\r\n  }\r\n\r\n  async onDeleteItem(id) {\r\n    const newItems = this.state.items.filter(item => item.id !== id);\r\n    this.setState({\r\n      items: newItems\r\n    })\r\n    // Use client TeamsFx SDK to call \"todo\" Azure Function in \"delete\" method to delete a todo item\r\n    await this.callFunctionWithErrorHandling(\"todo\", \"delete\", { id });\r\n  }\r\n\r\n  async onCompletionStatusChange(id, index, isCompleted) {\r\n    this.handleInputChange(index, \"isCompleted\", isCompleted);\r\n    // Use client TeamsFx SDK to call \"todo\" Azure Function in \"put\" method to update a todo item to completed\r\n    await this.callFunctionWithErrorHandling(\"todo\", \"put\", { id, isCompleted });\r\n  }\r\n\r\n  handleInputChange(index, property, value) {\r\n    const newItems = JSON.parse(JSON.stringify(this.state.items))\r\n    newItems[index][property] = value;\r\n    this.setState({\r\n      items: newItems\r\n    })\r\n  }\r\n\r\n  async refresh() {\r\n    await this.getItems();\r\n  }\r\n\r\n  render() {\r\n    const items = this.state.items?.map((item, index) =>\r\n      <div key={index} className=\"item\">\r\n        <div className=\"complete\">\r\n          <Checkbox\r\n            checked={this.state.items[index].isCompleted}\r\n            onChange={(e, { checked }) => this.onCompletionStatusChange(item.id, index, checked)}\r\n            className=\"is-completed-input\"\r\n          />\r\n        </div>\r\n        <div className=\"description\">\r\n          <Input\r\n            value={this.state.items[index].description}\r\n            onChange={(e) => this.handleInputChange(index, \"description\", e.target.value)}\r\n            onKeyDown={(e) => {\r\n              if (e.key === 'Enter') {\r\n                this.onUpdateItem(item.id, this.state.items[index].description);\r\n                e.target.blur();\r\n              }\r\n            }}\r\n            onBlur={() => this.onUpdateItem(item.id, this.state.items[index].description)}\r\n            className={\"text\" + (this.state.items[index].isCompleted ? \" is-completed\" : \"\")}\r\n          />\r\n        </div>\r\n        <Creator objectId={item.objectId} credential={this.credential} scope={this.scope} />\r\n        <div className=\"action\">\r\n          <MenuButton\r\n            trigger={<Button content=\"...\" />}\r\n            menu={[\r\n              {\r\n                content: 'Delete',\r\n                onClick: () => this.onDeleteItem(item.id)\r\n              }\r\n            ]}\r\n            on=\"click\"\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div>\r\n        {this.state.showLoginPage === false && <div className=\"flex-container\">\r\n          <div className=\"todo-col\">\r\n            <div className=\"todo\">\r\n              <div className=\"header\">\r\n                <div className=\"title\">\r\n                  <h2>To Do List</h2>\r\n                  <span>{this.state.items.length} item{this.state.items.length === 1 ? \"\" : \"s\"}</span>\r\n                </div>\r\n\r\n                <div className=\"add-button\">\r\n                  <Button primary onClick={() => this.setState({ isAddingItem: true })}>+ Add task</Button>\r\n                </div>\r\n              </div>\r\n\r\n              {this.state.items.length > 0 && <div className=\"header-container\">\r\n                <div className=\"note\">\r\n                  <svg width=\"12\" height=\"16\" viewBox=\"0 0 12 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                    <path d=\"M11.0312 1.00781H12V16H0V1.00781H0.984375V0H1.98438V1.00781H4V0H5V1.00781H7.01562V0H8.01562V1.00781H10.0312V0H11.0312V1.00781ZM11 15V2.00781H1V15H11ZM9 4.00781V5.00781H3V4.00781H9ZM3 13.0156V12.0156H9V13.0156H3ZM3 9.00781V8.00781H9V9.00781H3Z\" fill=\"black\" />\r\n                  </svg>\r\n                  <span>Note</span>\r\n                </div>\r\n                <div className=\"created-by\">\r\n                  <svg width=\"16\" height=\"12\" viewBox=\"0 0 16 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                    <path d=\"M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5Z\" fill=\"#242424\" />\r\n                    <path d=\"M2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879Z\" fill=\"#242424\" />\r\n                    <path d=\"M9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5Z\" fill=\"#242424\" />\r\n                    <path d=\"M9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5Z\" fill=\"#242424\" />\r\n                    <path d=\"M0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z\" fill=\"#242424\" />\r\n                  </svg>\r\n                  <span>Created By</span>\r\n                </div>\r\n              </div>}\r\n\r\n              {items}\r\n\r\n              {this.state.isAddingItem && <div className=\"item add\">\r\n                <div className=\"complete\">\r\n                  <Checkbox\r\n                    disabled\r\n                    className=\"is-completed-input\"\r\n                  />\r\n                </div>\r\n                <div className=\"description\">\r\n                  <Input\r\n                    autoFocus\r\n                    type=\"text\"\r\n                    value={this.state.newItemDescription}\r\n                    onChange={(e) => this.setState({ newItemDescription: e.target.value })}\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter') {\r\n                        this.onAddItem();\r\n                      }\r\n                    }}\r\n                    onBlur={() => {\r\n                      if (this.state.newItemDescription) {\r\n                        this.onAddItem();\r\n                      }\r\n                      this.setState({\r\n                        isAddingItem: false,\r\n                      });\r\n                    }}\r\n                    className=\"text\"\r\n                  />\r\n                </div>\r\n              </div>}\r\n\r\n              {this.state.initialized && !this.state.items.length && !this.state.isAddingItem && <div className=\"no-item\">\r\n                <div>\r\n                  <img src={noItemimage} alt=\"no item\" />\r\n                </div>\r\n                <div>\r\n                  <h2>No tasks</h2>\r\n                  <p>Add more tasks to make you day productive.</p>\r\n                </div>\r\n              </div>}\r\n            </div>\r\n          </div>\r\n        </div>}\r\n\r\n        {this.state.showLoginPage === true && <div className=\"auth\">\r\n          <Profile userInfo={this.state.userInfo} />\r\n          <h2>Welcome to To Do List App!</h2>\r\n          <Button primary onClick={() => this.loginBtnClick()}>Start</Button>\r\n        </div>}\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Tab;\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './App.css';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\n\r\n/**\r\n * The 'Config' component is used to display your group tabs\r\n * user configuration options.  Here you will allow the user to\r\n * make their choices and once they are done you will need to validate\r\n * their choices and communicate that to Teams to enable the save button.\r\n */\r\nclass TabConfig extends React.Component {\r\n\r\n  render() {\r\n    // Initialize the Microsoft Teams SDK\r\n    microsoftTeams.initialize();\r\n\r\n    /**\r\n     * When the user clicks \"Save\", save the url for your configured tab.\r\n     * This allows for the addition of query string parameters based on\r\n     * the settings selected by the user.\r\n     */\r\n    microsoftTeams.settings.registerOnSaveHandler((saveEvent) => {\r\n      const baseUrl = `https://${window.location.hostname}:${window.location.port}`;\r\n      microsoftTeams.settings.setSettings({\r\n        \"suggestedDisplayName\": \"Todo List\",\r\n        \"entityId\": \"Test\",\r\n        \"contentUrl\": baseUrl + \"/index.html#/tab\",\r\n        \"websiteUrl\": baseUrl + \"/index.html#/tab\"\r\n      });\r\n      saveEvent.notifySuccess();\r\n    });\r\n\r\n    /**\r\n     * After verifying that the settings for your tab are correctly\r\n     * filled in by the user you need to set the state of the dialog\r\n     * to be valid.  This will enable the save button in the configuration\r\n     * dialog.\r\n     */\r\n    microsoftTeams.settings.setValidityState(true);\r\n\r\n    return (\r\n      <div>\r\n        <h1>Tab Configuration</h1>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TabConfig;\r\n","import * as React from 'react';\nimport { Button } from '@fluentui/react-northstar';\nimport \"./Camera.css\";\nimport { uploadUserImage } from './data';\n\nconst width = 320;\nconst height = 240;\n\nexport const Camera = ({userId}) => {\n  const videoRef = React.useRef(null);\n  const canvasRef = React.useRef(null);\n  const photoRef = React.useRef(null);\n  React.useEffect(() => {\n    if (videoRef.current) {\n      init(videoRef.current);\n    }\n  }, [videoRef]);\n\n  const onCameraClick = (e) => {\n    takePicture(canvasRef.current, videoRef.current, photoRef);\n    e.preventDefault();\n  };\n\n  const onConfirmClick = () => {\n    // upload to server\n    uploadUserImage(userId, photoRef.current);\n  };\n\n  const onCancelClick = () => {\n    clearPhoto(canvasRef.current, photoRef.current);\n  };\n\n  const onVideoCanPlay = () => {\n    console.log(\"can play\");\n  };\n\n  return (\n    <>\n      <video\n        onCanPlay={onVideoCanPlay}\n        ref={videoRef}\n        className={\"videoContainer\"}\n      ></video>\n      <Button content={\"Take photo\"} onClick={onCameraClick} />\n      <canvas ref={canvasRef} className={\"canvasContainer\"}></canvas>\n      <Button content={\"Upload\"} onClick={onConfirmClick} />\n      <Button content={\"Cancel\"} onClick={onCancelClick} />\n    </>\n  );\n};\n\nexport const init = (video) => {\n  navigator.mediaDevices\n    .getUserMedia({\n      video: true,\n      audio: false,\n    })\n    .then(function (stream) {\n      video.srcObject = stream;\n      video.play();\n    })\n    .catch(function (err) {\n      console.log(\"An error occurred: \" + err);\n    });\n};\n\nexport const takePicture = (canvas, video, photoRef) => {\n  var context = canvas.getContext(\"2d\");\n  if (width && height) {\n    canvas.width = width;\n    canvas.height = height;\n    context.drawImage(video, 0, 0, width, height);\n\n    var data = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\");\n    photoRef.current = data;\n    console.log(`take photo`);\n  } else {\n    clearPhoto(canvas, photo);\n  }\n};\n\nexport const clearPhoto = (canvas, photo) => {\n  var context = canvas.getContext(\"2d\");\n  context.fillStyle = \"#AAA\";\n  context.fillRect(0, 0, canvas.width, canvas.height);\n  photo = null;\n  console.log(`photo: ${JSON.stringify(photo)}`);\n};\n","import axios from \"axios\";\nimport {v4 as uuid} from 'uuid';\n\nexport const uploadUserImage = (userId, photo) => {\n  axios\n    .post(\"https://customemojiwebapiapi.azure-api.net/v1/CustomEmoji\", {\n     emoji_id: new uuid(),\n     emoji_display_name:\"test\",\n     emoji_autho_userId: userId,\n     emoji_state:1,\n     emoji_base64_content: JSON.stringify(photo),\n    })\n    .then((response) => {\n      // check image id?\n      console.log(\"upload succeed\");\n    })\n    .catch((e) => {\n      console.log(`upload failed: ${e}`);\n    });\n};\n\nexport const deleteUserImage = () => {\n  axios\n    .delete(\"\", { userId })\n    .then(() => {\n      console.log(\"delete images succeed\");\n    })\n    .catch((e) => {\n      console.log(`delete images failed: ${e}`);\n    });\n};\n\nexport const getCustomImages = (userId) => {\n return axios\n    .get(`https://customemojiwebapiapi.azure-api.net/v1/CustomEmoji`,{headers:{'Access-Control-Allow-Origin' : '*'}})\n    .then((response) => {\n      console.log(`fetch images succeed: ${response}`);\n      const images = JSON.parse(response);\n      return images.map((image) => {\n      return {\n          id: image.emoji_id,\n          name: image.emoji_display_name,\n          source: image.emoji_url,\n        };\n      });\n    })\n    .catch((e) => {\n      console.log(`fetch images failed: ${e}`);\n    });\n};\n\nexport const selectCustomImage = (\n  emojiId,\n  userId,\n  msgId,\n  chatId,\n  emotionSrc\n) => {\n  axios\n    .post(\"https://www.l2b.ltd/api/message-reactions\", {\n      emoji_id: emojiId,\n      user_id: userId,\n      message_id: msgId,\n      chat_id: chatId,\n      emoji_url: emotionSrc,\n    })\n    .then(() => {\n      console.log(\"select image succeed\");\n    })\n    .catch((e) => {\n      console.log(`select image failed: ${e}`);\n    });\n};\n","import _ from 'lodash'\r\n\r\nconst imageNames = [\r\n    'WandaHoward',\r\n    'TimDeboer',\r\n    'RobinCounts',\r\n    'RobertTolbert',\r\n    'MonaKane',\r\n    'MiguelGarcia',\r\n    'MauricioAugust',\r\n    'LydiaBauer',\r\n    'KristinPatterson',\r\n    'KevinSturgis',\r\n    'KatriAthokas',\r\n    'KatLarsson',\r\n    'JohnieMcConnell',\r\n    'IsaacFielder',\r\n    'HenryBrill',\r\n    'ErikNason',\r\n    'ElviaAtkins',\r\n  ];\r\n\r\nexport const getAllMockEmojis = () => _.map(imageNames, imageName => (\r\n    {\r\n        id: imageName,\r\n        name: imageName, \r\n        src: `https://fabricweb.azureedge.net/fabric-website/assets/images/avatar/${imageName}.jpg`\r\n    }\r\n  ))","import * as React from \"react\";\r\nimport {\r\n  Grid,\r\n  Image,\r\n  Button,\r\n  gridHorizontalBehavior,\r\n  AddIcon,\r\n  Text,\r\n} from \"@fluentui/react-northstar\";\r\nimport { getAllMockEmojis } from \"./MockData\";\r\nimport { getCustomImages, selectCustomImage } from \"./data\";\r\n\r\nconst imageButtonStyles = {\r\n  minWidth: \"150px\",\r\n  maxWidth: \"150px\",\r\n  height: \"150px\",\r\n  padding: \"0\",\r\n  margin: \"5px\",\r\n};\r\n\r\nconst renderImageButtons = (allEmojis, onEmojiClick) => {\r\n  // Todo: get emoji from server\r\n  // const allEmojis = await getCustomImages(\"\");//getAllMockEmojis();\r\n  const onClick = (emoji) => {\r\n    onEmojiClick(emoji);\r\n  };\r\n  return (\r\n    allEmojis &&\r\n    allEmojis.map((emoji) => (\r\n      <Button\r\n        key={emoji.id}\r\n        styles={imageButtonStyles}\r\n        title={emoji.name}\r\n        onClick={()=>onClick(emoji)}\r\n      >\r\n        <Image fluid src={emoji.src} />\r\n      </Button>\r\n    ))\r\n  );\r\n};\r\n\r\nconst renderAddEmojiButton = () => {\r\n  const fileInputRef = React.useRef(null);\r\n\r\n  const onAddButtonClick = React.useCallback(() => {\r\n    if (fileInputRef && fileInputRef.current) {\r\n      fileInputRef.current.click();\r\n    }\r\n  });\r\n\r\n  const fileUploadInputChange = React.useCallback((e) => {\r\n    // Todo: get upload file and update to server\r\n    // uploaded file: e.target.value\r\n  });\r\n\r\n  return (\r\n    <div>\r\n      <input\r\n        id=\"fileButton\"\r\n        ref={fileInputRef}\r\n        onChange={fileUploadInputChange}\r\n        type=\"file\"\r\n        hidden\r\n      />\r\n      <Button\r\n        key={\"add_emoji\"}\r\n        styles={imageButtonStyles}\r\n        onClick={onAddButtonClick}\r\n      >\r\n        <AddIcon />\r\n        <Text weight=\"semibold\" content=\"Upload Emoji\" />\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst renderGridContents = (allEmojis, onEmojiClick) => {\r\n  const allEmojisButtons = renderImageButtons(allEmojis, onEmojiClick);\r\n  const addEmojiButton = renderAddEmojiButton();\r\n  allEmojisButtons && allEmojisButtons.unshift(addEmojiButton);\r\n  return allEmojisButtons || addEmojiButton;\r\n};\r\n\r\nexport const CustomEmojisComponent = ({ messageId, userId, convId }) => {\r\n  const [allEmojis, setAllEmojis] = React.useState([]);\r\n  React.useEffect(() => {\r\n    getCustomImages(\"\").then((emojis) => {\r\n      if(!emojis){\r\n        setAllEmojis(getAllMockEmojis());\r\n      }else{\r\n      setAllEmojis(emojis);\r\n      }\r\n    });\r\n  }, []);\r\n  const onEmojiClick = (emoji) => {\r\n    selectCustomImage(emoji.id, userId, messageId, convId, emoji.src);\r\n  };\r\n  return (\r\n    <div>\r\n      <Grid\r\n        accessibility={gridHorizontalBehavior}\r\n        columns={8}\r\n        content={renderGridContents(allEmojis, onEmojiClick)}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import * as React from 'react';\r\nimport { Menu } from '@fluentui/react-northstar';\r\nimport { Camera } from './Camera';\r\nimport {CustomEmojisComponent} from './CustomEmojis';\r\n\r\nconst items = [\r\n    {\r\n      key: 'custom_emojis',\r\n      content: 'Custom Emojis',\r\n    },\r\n    {\r\n      key: 'shoot_emoji',\r\n      content: 'Shoot emoji',\r\n    }\r\n  ]\r\n\r\nexport const MainPage = ({messageId, userId, convId}) => {\r\n    const [activeIndex, setActiveIndex] = React.useState(0);\r\n    const onActiveIndexChange = React.useCallback((i, j) => {\r\n        setActiveIndex(j.activeIndex);\r\n    });\r\n\r\n    return <div>\r\n        <Menu\r\n        defaultActiveIndex={0}\r\n        items={items}\r\n        underlined\r\n        primary\r\n        onActiveIndexChange={onActiveIndexChange}\r\n  />\r\n  {activeIndex === 0 && <CustomEmojisComponent messageId={messageId} userId={userId} convId={convId}/>}\r\n  {activeIndex === 1 && <Camera userId={userId} />}\r\n  </div>;\r\n}","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './App.css';\r\nimport * as microsoftTeams from '@microsoft/teams-js';\r\nimport { BrowserRouter as Router, Route, useLocation, useParams } from 'react-router-dom';\r\n\r\nimport Privacy from './about/Privacy';\r\nimport TermsOfUse from './about/TermsOfUse';\r\nimport Tab from './Tab';\r\nimport TabConfig from './TabConfig';\r\nimport { MainPage } from './MainPage';\r\n\r\n/**\r\n * The main app which handles the initialization and routing\r\n * of the app.\r\n */\r\nfunction App() {\r\n  // Check for the Microsoft Teams SDK object.\r\n  if (microsoftTeams) {\r\n    return (\r\n      <Router>\r\n        <Parent />\r\n       \r\n      </Router>\r\n    );\r\n  } else {\r\n    return (\r\n      <h3>Microsoft Teams SDK not found.</h3>\r\n    );\r\n  }\r\n}\r\n\r\nfunction Parent() {\r\n  const query = new URLSearchParams(useLocation().search);\r\n  console.log(query.toString());\r\n  return <Child messageId={query.get(\"messageId\")} userId={query.get(\"userId\")} convId={query.get(\"convId\")} />\r\n}\r\n\r\nfunction Child({messageId, userId, convId}) {\r\n  return (\r\n    <div>\r\n        <h1>messageId: {messageId} </h1>\r\n        <h1>userId: {userId} </h1>\r\n        <h1>convId: {convId} </h1>\r\n        <MainPage messageId={messageId} userId={userId} convId={convId}/>    \r\n    </div>\r\n  )\r\n}\r\n\r\nexport default App;\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './components/App';\r\nimport { Provider, teamsTheme } from '@fluentui/react-northstar' //https://fluentsite.z22.web.core.windows.net/quick-start\r\n\r\nReactDOM.render(\r\n    <Provider theme={teamsTheme}>\r\n        <App />\r\n    </Provider>, document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}