{"version":3,"sources":["components/Camera.jsx","components/data.js","components/MockData.js","components/CustomEmojis.jsx","components/MainPage.jsx","components/App.js","index.js"],"names":["Camera","userId","videoRef","React","canvasRef","photoRef","current","init","onCanPlay","console","log","ref","className","Button","content","onClick","e","takePicture","preventDefault","photo","axios","post","emoji_id","uuid","emoji_display_name","emoji_author_userId","emoji_description","emoji_state","emoji_base64_content","then","response","catch","uploadUserImage","clearPhoto","video","navigator","mediaDevices","getUserMedia","audio","stream","srcObject","play","err","canvas","context","getContext","width","height","drawImage","data","toDataURL","cleanData","index","indexOf","substring","fillStyle","fillRect","JSON","stringify","imageNames","imageButtonStyles","margin","AddEmoji","style","fileInputRef","onAddButtonClick","click","fileUploadInputChange","id","onChange","type","hidden","text","styles","AddIcon","Text","weight","EmojiRenderer","props","columnIndex","rowIndex","columnCount","item","items","length","onEmojiClick","emoji","emojiId","msgId","chatId","emotionSrc","user_id","message_id","chat_id","emoji_url","selectCustomImage","messageId","convId","src","title","name","Image","maxHeight","maxWidth","CustomEmojisComponent","allEmojis","setAllEmojis","get","map","image","emojis","_","imageName","gridData","rowCount","Math","ceil","itemData","virtualizedGrid","columnWidth","floor","rowHeight","initialScrollTop","overflowX","autoSizerChild","Grid","accessibility","gridHorizontalBehavior","key","MainPage","query","URLSearchParams","useLocation","search","activeIndex","setActiveIndex","onActiveIndexChange","i","j","Menu","defaultActiveIndex","underlined","primary","App","microsoftTeams","ReactDOM","render","Provider","theme","teamsTheme","document","getElementById"],"mappings":"+YAQaA,EAAS,SAAC,GAAgB,IAAdC,EAAa,EAAbA,OACjBC,EAAWC,SAAa,MACxBC,EAAYD,SAAa,MACzBE,EAAWF,SAAa,MAC9BA,aAAgB,WACVD,EAASI,SACXC,EAAKL,EAASI,WAEf,CAACJ,IAoBJ,OACE,qCACE,uBACEM,UAPiB,WACrBC,QAAQC,IAAI,aAORC,IAAKT,EACLU,UAAW,mBAEb,cAACC,EAAA,EAAD,CAAQC,QAAS,aAAcC,QAzBb,SAACC,GACrBC,EAAYb,EAAUE,QAASJ,EAASI,QAASD,GACjDW,EAAEE,oBAwBA,wBAAQP,IAAKP,EAAWQ,UAAW,oBACnC,cAACC,EAAA,EAAD,CAAQC,QAAS,SAAUC,QAtBR,YCpBM,SAACd,EAAQkB,GACtCC,IACGC,KAAK,qCAAsC,CAC3CC,SAAUC,cACVC,mBAAmB,OACnBC,oBAAqBxB,EACrByB,kBAAkB,mBAClBC,YAAY,EACZC,qBAAsBT,IAEtBU,MAAK,SAACC,GAELrB,QAAQC,IAAI,qBAEbqB,OAAM,SAACf,GACNP,QAAQC,IAAR,yBAA8BM,ODOhCgB,CAAgB/B,EAAQI,EAASC,YAqB/B,cAACO,EAAA,EAAD,CAAQC,QAAS,SAAUC,QAlBT,WACpBkB,EAAW7B,EAAUE,QAASD,EAASC,gBAsB9BC,EAAO,SAAC2B,GACnBC,UAAUC,aACPC,aAAa,CACZH,OAAO,EACPI,OAAO,IAERT,MAAK,SAAUU,GACdL,EAAMM,UAAYD,EAClBL,EAAMO,UAEPV,OAAM,SAAUW,GACfjC,QAAQC,IAAI,sBAAwBgC,OAI7BzB,EAAc,SAAC0B,EAAQT,EAAO7B,GACzC,IAAIuC,EAAUD,EAAOE,WAAW,MAE9BF,EAAOG,MAhEG,IAiEVH,EAAOI,OAhEI,IAiEXH,EAAQI,UAAUd,EAAO,EAAG,EAlElB,IACC,KAmEX,IAAIe,EAAON,EAAOO,UAAU,aAE5B7C,EAASC,QAAU6C,EAAUF,GAC7BxC,QAAQC,IAAR,eAMEyC,EAAU,SAACF,GACf,IAAMG,EAAMH,EAAKI,QAAQ,WACzB,OAAOJ,EAAKK,UAAUF,EAAM,IAGjBnB,EAAa,SAACU,EAAQxB,GACjC,IAAIyB,EAAUD,EAAOE,WAAW,MAChCD,EAAQW,UAAY,OACpBX,EAAQY,SAAS,EAAG,EAAGb,EAAOG,MAAOH,EAAOI,QAE5CtC,QAAQC,IAAR,iBAAsB+C,KAAKC,UADnB,S,wFEzFJC,EAAa,CACjB,cACA,YACA,cACA,gBACA,WACA,eACA,iBACA,aACA,mBACA,eACA,eACA,aACA,kBACA,eACA,aACA,YACA,eCLIC,EAAoB,CACxBd,MAAO,oBACPC,OAAQ,MACRc,OAAQ,YAGJC,EAAW,SAAC,GAAe,IAAbC,EAAY,EAAZA,MACZC,EAAe7D,SAAa,MAE5B8D,EAAmB9D,eAAkB,WACrC6D,GAAgBA,EAAa1D,SAC/B0D,EAAa1D,QAAQ4D,WAInBC,EAAwBhE,eAAkB,SAACa,OAKjD,OACE,sBAAK+C,MAAOA,EAAZ,UACE,uBACEK,GAAG,aACHzD,IAAKqD,EACLK,SAAUF,EACVG,KAAK,OACLC,QAAM,IAER,eAAC1D,EAAA,EAAD,CACE2D,MAAI,EAEJC,OAAQb,EACR7C,QAASkD,EAJX,UAME,cAACS,EAAA,EAAD,IACA,cAACC,EAAA,EAAD,CAAMC,OAAO,WAAW9D,QAAQ,mBAL3B,iBAWP+D,EAAgB,SAACC,GACrB,IAAQC,EAAuCD,EAAvCC,YAAa9B,EAA0B6B,EAA1B7B,KAAM+B,EAAoBF,EAApBE,SAAUjB,EAAUe,EAAVf,MAC/BX,EAAQ4B,EAAW/B,EAAKgC,YAAcF,EAEtCG,EACJjC,EAAKkC,OAASlC,EAAKkC,MAAMC,OAAShC,EAAQH,EAAKkC,MAAM/B,GAAS,KAChE,IAAK8B,EACH,OAAO,KAET,GAAgB,cAAZA,EAAKd,GACP,OAAO,cAAC,EAAD,CAAUL,MAAOA,IAG1B,IAAMsB,EAAe,SAACC,IFjBS,SAC/BC,EACAtF,EACAuF,EACAC,EACAC,GAEAtE,IACGC,KAAK,4CAA6C,CACjDC,SAAUiE,EACVI,QAAS1F,EACT2F,WAAYJ,EACZK,QAASJ,EACTK,UAAWJ,IAEZ7D,MAAK,WACJpB,QAAQC,IAAI,2BAEbqB,OAAM,SAACf,GACNP,QAAQC,IAAR,+BAAoCM,OEDtC+E,CACET,EAAMlB,GACNnB,EAAKhD,OACLgD,EAAK+C,UACL/C,EAAKgD,OACLX,EAAMY,MAIV,OACE,qBAAKnC,MAAOA,EAAZ,SACE,cAAClD,EAAA,EAAD,CACE4D,OAAQb,EACRY,MAAI,EAEJ2B,MAAOjB,EAAKkB,KACZrF,QAAS,kBAAMsE,EAAaH,IAL9B,SAOE,cAACmB,EAAA,EAAD,CAAOtC,MAAO,CAAEuC,UAAW,OAAQC,SAAU,QAAUL,IAAKhB,EAAKgB,OAJ5DhB,EAAKd,OAULoC,EAAwB,SAAC,GAAmC,IAAjCR,EAAgC,EAAhCA,UAAW/F,EAAqB,EAArBA,OAAQgG,EAAa,EAAbA,OACzD,EAAkC9F,WAAe,IAAjD,mBAAOsG,EAAP,KAAkBC,EAAlB,KACAvG,aAAgB,WF9DViB,IACHuF,IADG,sCAEH9E,MAAK,SAACC,GAGL,OAFArB,QAAQC,IAAR,gCAAqCoB,IACvBA,EAASmB,KACT2D,KAAI,SAACC,GACnB,MAAO,CACHzC,GAAIyC,EAAMvF,SACV8E,KAAMS,EAAMrF,mBACZ0E,IAAKW,EAAMf,iBAIhB/D,OAAM,SAACf,GACNP,QAAQC,IAAR,+BAAoCM,OEiDda,MAAK,SAACiF,GAI1BJ,EAHGI,GD3ETC,IAAEH,IAAIjD,GAAY,SAACqD,GAAD,MAAgB,CAChC5C,GAAI4C,EACJZ,KAAMY,EACNd,IAAI,uEAAD,OAAyEc,EAAzE,kBC8EF,IAEH,IAAMC,EAAQ,CAAI,CAAE7C,GAAI,cAAV,mBAA4BqC,IAGpCS,EAAWC,KAAKC,KAAKH,EAAS7B,OADhB,GAEdiC,EAAWlH,WAAc,iBAAO,CACpC8E,YAHkB,EAIlBE,MAAO8B,EACPjB,YACA/F,SACAgG,aAuBIqB,EACJ,cAAC,IAAD,UACG,mBAtBkB,SAACvE,EAAQD,GAC9B,IAAMyE,EAAcJ,KAAKK,MAAM1E,EAXb,GAYlB,OACE,cAAC,IAAD,CACElC,UAAW,gBACXqE,YAfc,EAgBdiC,SAAUA,EACVpE,MAAOA,EACPC,OAAQA,EACRwE,YAAaA,EACbE,UAAW,IACXC,iBAAkB,EAClBL,SAAUA,EACVtD,MAAO,CAAE4D,UAAW,UAVtB,SAYG9C,IAOqB+C,CAAvB,EAAG7E,OAAH,EAAWD,UAIhB,OACE,cAAC+E,EAAA,EAAD,CACEC,cAAeC,IACfjH,QAASwG,EACTvD,MAAO,CAAEhB,OAAQ,OAAQD,MAAO,WC7IhCqC,G,OAAQ,CACZ,CACE6C,IAAK,gBACLlH,QAAS,iBAEX,CACEkH,IAAK,cACLlH,QAAS,iBAIAmH,EAAW,WACtB,IAAMC,EAAQ,IAAIC,gBAAgBC,cAAcC,QAC1CrC,EAAYkC,EAAMvB,IAAI,aACtB1G,EAASiI,EAAMvB,IAAI,UACnBV,EAASiC,EAAMvB,IAAI,UAEzB,EAAsCxG,WAAe,GAArD,mBAAOmI,EAAP,KAAoBC,EAApB,KACMC,EAAsBrI,eAAkB,SAACsI,EAAGC,GAChDH,EAAeG,EAAEJ,gBAGnB,OACE,sBAAKlE,GAAG,YAAYL,MAAO,CAAEhB,OAAQ,QAArC,UACE,cAAC4F,EAAA,EAAD,CACEC,mBAAoB,EACpBzD,MAAOA,EACP0D,YAAU,EACVC,SAAO,EACPN,oBAAqBA,IAEN,IAAhBF,GACC,cAAC,EAAD,CACEtC,UAAWA,EACX/F,OAAQA,EACRgG,OAAQA,IAGK,IAAhBqC,GAAqB,cAAC,EAAD,CAAQrI,OAAQA,QCK7B8I,MApCf,WAEE,OAAIC,EAEA,cAAC,IAAD,UACE,cAAC,EAAD,MAIG,iE,kBCdXC,IAASC,OACL,cAACC,EAAA,EAAD,CAAUC,MAAOC,IAAjB,SACI,cAAC,EAAD,MACSC,SAASC,eAAe,W","file":"static/js/main.76f2c3c4.chunk.js","sourcesContent":["import * as React from \"react\";\r\nimport { Button } from \"@fluentui/react-northstar\";\r\nimport \"./Camera.css\";\r\nimport { uploadUserImage } from \"./data\";\r\n\r\nconst width = 320;\r\nconst height = 240;\r\n\r\nexport const Camera = ({ userId }) => {\r\n  const videoRef = React.useRef(null);\r\n  const canvasRef = React.useRef(null);\r\n  const photoRef = React.useRef(null);\r\n  React.useEffect(() => {\r\n    if (videoRef.current) {\r\n      init(videoRef.current);\r\n    }\r\n  }, [videoRef]);\r\n\r\n  const onCameraClick = (e) => {\r\n    takePicture(canvasRef.current, videoRef.current, photoRef);\r\n    e.preventDefault();\r\n  };\r\n\r\n  const onConfirmClick = () => {\r\n    // upload to server\r\n    uploadUserImage(userId, photoRef.current);\r\n  };\r\n\r\n  const onCancelClick = () => {\r\n    clearPhoto(canvasRef.current, photoRef.current);\r\n  };\r\n\r\n  const onVideoCanPlay = () => {\r\n    console.log(\"can play\");\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <video\r\n        onCanPlay={onVideoCanPlay}\r\n        ref={videoRef}\r\n        className={\"videoContainer\"}\r\n      ></video>\r\n      <Button content={\"Take photo\"} onClick={onCameraClick} />\r\n      <canvas ref={canvasRef} className={\"canvasContainer\"}></canvas>\r\n      <Button content={\"Upload\"} onClick={onConfirmClick} />\r\n      <Button content={\"Cancel\"} onClick={onCancelClick} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport const init = (video) => {\r\n  navigator.mediaDevices\r\n    .getUserMedia({\r\n      video: true,\r\n      audio: false,\r\n    })\r\n    .then(function (stream) {\r\n      video.srcObject = stream;\r\n      video.play();\r\n    })\r\n    .catch(function (err) {\r\n      console.log(\"An error occurred: \" + err);\r\n    });\r\n};\r\n\r\nexport const takePicture = (canvas, video, photoRef) => {\r\n  var context = canvas.getContext(\"2d\");\r\n  if (width && height) {\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    context.drawImage(video, 0, 0, width, height);\r\n\r\n    var data = canvas.toDataURL(\"image/png\")\r\n    // .replace(\"image/png\", \"image/octet-stream\");\r\n    photoRef.current = cleanData(data);\r\n    console.log(`take photo`);\r\n  } else {\r\n    clearPhoto(canvas, photo);\r\n  }\r\n};\r\n\r\nconst cleanData=(data)=>{\r\n  const index=data.indexOf(\"base64,\");\r\n  return data.substring(index+7);\r\n}\r\n\r\nexport const clearPhoto = (canvas, photo) => {\r\n  var context = canvas.getContext(\"2d\");\r\n  context.fillStyle = \"#AAA\";\r\n  context.fillRect(0, 0, canvas.width, canvas.height);\r\n  photo = null;\r\n  console.log(`photo: ${JSON.stringify(photo)}`);\r\n};\r\n","import axios from \"axios\";\nimport {v4 as uuid} from 'uuid';\n\nexport const uploadUserImage = (userId, photo) => {\n  axios\n    .post(\"https://www.l2b.ltd/v1/CustomEmoji\", {\n     emoji_id: uuid(),\n     emoji_display_name:\"test\",\n     emoji_author_userId: userId,\n     emoji_description:\"test description\",\n     emoji_state:1,\n     emoji_base64_content: photo,\n    })\n    .then((response) => {\n      // check image id?\n      console.log(\"upload succeed\");\n    })\n    .catch((e) => {\n      console.log(`upload failed: ${e}`);\n    });\n};\n\nexport const deleteUserImage = () => {\n  axios\n    .delete(\"\", { userId })\n    .then(() => {\n      console.log(\"delete images succeed\");\n    })\n    .catch((e) => {\n      console.log(`delete images failed: ${e}`);\n    });\n};\n\nexport const getCustomImages = (userId) => {\n return axios\n    .get(`https://www.l2b.ltd/v1/CustomEmoji`)\n    .then((response) => {\n      console.log(`fetch images succeed: ${response}`);\n      const images =response.data;\n      return images.map((image) => {\n      return {\n          id: image.emoji_id,\n          name: image.emoji_display_name,\n          src: image.emoji_url,\n        };\n      });\n    })\n    .catch((e) => {\n      console.log(`fetch images failed: ${e}`);\n    });\n};\n\nexport const selectCustomImage = (\n  emojiId,\n  userId,\n  msgId,\n  chatId,\n  emotionSrc\n) => {\n  axios\n    .post(\"https://www.l2b.ltd/api/message-reactions\", {\n      emoji_id: emojiId,\n      user_id: userId,\n      message_id: msgId,\n      chat_id: chatId,\n      emoji_url: emotionSrc,\n    })\n    .then(() => {\n      console.log(\"select image succeed\");\n    })\n    .catch((e) => {\n      console.log(`select image failed: ${e}`);\n    });\n};\n","import _ from \"lodash\";\r\n\r\nconst imageNames = [\r\n  \"WandaHoward\",\r\n  \"TimDeboer\",\r\n  \"RobinCounts\",\r\n  \"RobertTolbert\",\r\n  \"MonaKane\",\r\n  \"MiguelGarcia\",\r\n  \"MauricioAugust\",\r\n  \"LydiaBauer\",\r\n  \"KristinPatterson\",\r\n  \"KevinSturgis\",\r\n  \"KatriAthokas\",\r\n  \"KatLarsson\",\r\n  \"JohnieMcConnell\",\r\n  \"IsaacFielder\",\r\n  \"HenryBrill\",\r\n  \"ErikNason\",\r\n  \"ElviaAtkins\",\r\n];\r\n\r\nexport const getAllMockEmojis = () =>\r\n  _.map(imageNames, (imageName) => ({\r\n    id: imageName,\r\n    name: imageName,\r\n    src: `https://fabricweb.azureedge.net/fabric-website/assets/images/avatar/${imageName}.jpg`,\r\n  }));\r\n","import * as React from \"react\";\r\nimport {\r\n  Grid,\r\n  Image,\r\n  Button,\r\n  gridHorizontalBehavior,\r\n  AddIcon,\r\n  Text,\r\n} from \"@fluentui/react-northstar\";\r\nimport { FixedSizeGrid } from \"react-window\";\r\nimport AutoSizer from \"react-virtualized-auto-sizer\";\r\nimport { getAllMockEmojis } from \"./MockData\";\r\nimport { getCustomImages, selectCustomImage } from \"./data\";\r\n\r\nconst imageButtonStyles = {\r\n  width: \"calc(100% - 10px)\",\r\n  height: \"80%\",\r\n  margin: \"10px 5px\",\r\n};\r\n\r\nconst AddEmoji = ({ style }) => {\r\n  const fileInputRef = React.useRef(null);\r\n\r\n  const onAddButtonClick = React.useCallback(() => {\r\n    if (fileInputRef && fileInputRef.current) {\r\n      fileInputRef.current.click();\r\n    }\r\n  });\r\n\r\n  const fileUploadInputChange = React.useCallback((e) => {\r\n    // Todo: get upload file and update to server\r\n    // uploaded file: e.target.value\r\n  });\r\n\r\n  return (\r\n    <div style={style}>\r\n      <input\r\n        id=\"fileButton\"\r\n        ref={fileInputRef}\r\n        onChange={fileUploadInputChange}\r\n        type=\"file\"\r\n        hidden\r\n      />\r\n      <Button\r\n        text\r\n        key={\"add_emoji\"}\r\n        styles={imageButtonStyles}\r\n        onClick={onAddButtonClick}\r\n      >\r\n        <AddIcon />\r\n        <Text weight=\"semibold\" content=\"Upload Emoji\" />\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst EmojiRenderer = (props) => {\r\n  const { columnIndex, data, rowIndex, style } = props;\r\n  const index = rowIndex * data.columnCount + columnIndex;\r\n\r\n  const item =\r\n    data.items && data.items.length > index ? data.items[index] : null;\r\n  if (!item) {\r\n    return null;\r\n  }\r\n  if (item.id === \"add-emoji\") {\r\n    return <AddEmoji style={style} />;\r\n  }\r\n\r\n  const onEmojiClick = (emoji) => {\r\n    selectCustomImage(\r\n      emoji.id,\r\n      data.userId,\r\n      data.messageId,\r\n      data.convId,\r\n      emoji.src\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div style={style}>\r\n      <Button\r\n        styles={imageButtonStyles}\r\n        text\r\n        key={item.id}\r\n        title={item.name}\r\n        onClick={() => onEmojiClick(item)}\r\n      >\r\n        <Image style={{ maxHeight: \"100%\", maxWidth: \"100%\" }} src={item.src} />\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const CustomEmojisComponent = ({ messageId, userId, convId }) => {\r\n  const [allEmojis, setAllEmojis] = React.useState([]);\r\n  React.useEffect(() => {\r\n    getCustomImages(userId).then((emojis) => {\r\n      if (!emojis) {\r\n        setAllEmojis(getAllMockEmojis());\r\n      } else {\r\n        setAllEmojis(emojis);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const gridData = [{ id: \"add-emoji\" }, ...allEmojis];\r\n\r\n  const columnCount = 6;\r\n  const rowCount = Math.ceil(gridData.length / columnCount);\r\n  const itemData = React.useMemo(() => ({\r\n    columnCount,\r\n    items: gridData,\r\n    messageId,\r\n    userId,\r\n    convId,\r\n  }));\r\n\r\n  const autoSizerChild = (height, width) => {\r\n    const columnWidth = Math.floor(width / columnCount);\r\n    return (\r\n      <FixedSizeGrid\r\n        className={\"FixedSizeGrid\"}\r\n        columnCount={columnCount}\r\n        rowCount={rowCount}\r\n        width={width}\r\n        height={height}\r\n        columnWidth={columnWidth}\r\n        rowHeight={150}\r\n        initialScrollTop={0}\r\n        itemData={itemData}\r\n        style={{ overflowX: \"hidden\" }}\r\n      >\r\n        {EmojiRenderer}\r\n      </FixedSizeGrid>\r\n    );\r\n  };\r\n\r\n  const virtualizedGrid = (\r\n    <AutoSizer>\r\n      {({ height, width }) => autoSizerChild(height, width)}\r\n    </AutoSizer>\r\n  );\r\n\r\n  return (\r\n    <Grid\r\n      accessibility={gridHorizontalBehavior}\r\n      content={virtualizedGrid}\r\n      style={{ height: \"100%\", width: \"100%\" }}\r\n    />\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { Menu } from \"@fluentui/react-northstar\";\r\nimport { Camera } from \"./Camera\";\r\nimport { CustomEmojisComponent } from \"./CustomEmojis\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport \"./MainPage.css\";\r\n\r\nconst items = [\r\n  {\r\n    key: \"custom_emojis\",\r\n    content: \"Custom Emojis\",\r\n  },\r\n  {\r\n    key: \"shoot_emoji\",\r\n    content: \"Shoot emoji\",\r\n  },\r\n];\r\n\r\nexport const MainPage = () => {\r\n  const query = new URLSearchParams(useLocation().search);\r\n  const messageId = query.get(\"messageId\");\r\n  const userId = query.get(\"userId\");\r\n  const convId = query.get(\"convId\");\r\n\r\n  const [activeIndex, setActiveIndex] = React.useState(0);\r\n  const onActiveIndexChange = React.useCallback((i, j) => {\r\n    setActiveIndex(j.activeIndex);\r\n  });\r\n\r\n  return (\r\n    <div id=\"main-page\" style={{ height: \"100%\" }}>\r\n      <Menu\r\n        defaultActiveIndex={0}\r\n        items={items}\r\n        underlined\r\n        primary\r\n        onActiveIndexChange={onActiveIndexChange}\r\n      />\r\n      {activeIndex === 0 && (\r\n        <CustomEmojisComponent\r\n          messageId={messageId}\r\n          userId={userId}\r\n          convId={convId}\r\n        />\r\n      )}\r\n      {activeIndex === 1 && <Camera userId={userId} />}\r\n    </div>\r\n  );\r\n};\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from \"react\";\r\nimport \"./App.css\";\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\nimport { BrowserRouter as Router, useLocation } from \"react-router-dom\";\r\n\r\nimport { MainPage } from \"./MainPage\";\r\n\r\n/**\r\n * The main app which handles the initialization and routing\r\n * of the app.\r\n */\r\nfunction App() {\r\n  // Check for the Microsoft Teams SDK object.\r\n  if (microsoftTeams) {\r\n    return (\r\n      <Router>\r\n        <MainPage />\r\n      </Router>\r\n    );\r\n  } else {\r\n    return <h3>Microsoft Teams SDK not found.</h3>;\r\n  }\r\n}\r\n\r\nfunction Parent() {\r\n  const query = new URLSearchParams(useLocation().search);\r\n  console.log(query.toString());\r\n  return (\r\n    <Child\r\n      messageId={query.get(\"messageId\")}\r\n      userId={query.get(\"userId\")}\r\n      convId={query.get(\"convId\")}\r\n    />\r\n  );\r\n}\r\n\r\nfunction Child({ messageId, userId, convId }) {\r\n  return (\r\n    <div>\r\n      <h1>messageId: {messageId} </h1>\r\n      <h1>userId: {userId} </h1>\r\n      <h1>convId: {convId} </h1>\r\n      <MainPage messageId={messageId} userId={userId} convId={convId} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './components/App';\r\nimport { Provider, teamsTheme } from '@fluentui/react-northstar' //https://fluentsite.z22.web.core.windows.net/quick-start\r\n\r\nReactDOM.render(\r\n    <Provider theme={teamsTheme}>\r\n        <App />\r\n    </Provider>, document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}